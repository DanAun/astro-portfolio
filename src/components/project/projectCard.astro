---
import { HiArrowRight } from "react-icons/hi";
export interface Props {
  title: string;
  description: string;
  image: string;
  technologies: string[];
  read: string;
  code: string;
  category: string[];
  index: number;
}

const { title, description, image, technologies, read, code, category, index } = Astro.props;

// Convert array to comma-separated string for data attribute
const categoryString = Array.isArray(category) ? category.join(',') : category;

// Check if links are valid (not # or empty)
const isReadValid = read && read !== "#";
const isCodeValid = code && code !== "#";
---

<div
  data-index={index}
  data-category={categoryString}
  class="project-card z-10 flex w-[400px] flex-col overflow-hidden rounded-lg bg-gray-900 shadow-lg transition-transform hover:scale-[1.01] lg:w-[320px] drop-shadow-[4px_4px_0_#7836cf]"
>
  <img
    src={image}
    alt={`Image of project ${title}`}
    class="h-50 w-full rounded-2xl object-cover p-3"
  />
  <div class="flex grow flex-col px-3 pb-3">
    <h3 class="text-xl font-semibold text-white drop-shadow-[1px_1px_0_#7836cf]">{title}</h3>
    <div class="my-1.5 flex flex-wrap gap-2">
      {
        technologies.map((tech) => (
          <span class="rounded-md bg-[#7836cf]/20 text-[#a27ed1] px-2 py-0.5 text-xs font-semibold">
            {tech}
          </span>
        ))
      }
    </div>
    <p class="flex grow text-gray-400">{description}</p>
    <div class="mt-auto flex justify-between">
      <a
        class={`group mt-6 flex items-center justify-start p-0 font-bold text-lg ${
          isReadValid ? 'text-primary cursor-pointer' : 'text-gray-600 cursor-not-allowed opacity-50'
        }`}
        href={isReadValid ? read : undefined}
        {...(isReadValid ? { target: "_blank", rel: "noopener noreferrer" } : { 'aria-disabled': 'true' })}
      >
        Read
        <HiArrowRight
          className={`ml-1 transition-transform duration-200 ${isReadValid ? 'group-hover:translate-x-1' : ''}`}
          size={18}
        />
      </a>
      <a
        class={`group mt-6 flex items-center justify-start p-0 font-bold text-lg ${
          isCodeValid ? 'text-primary cursor-pointer' : 'text-gray-600 cursor-not-allowed opacity-50'
        }`}
        href={isCodeValid ? code : undefined}
        {...(isCodeValid ? { target: "_blank", rel: "noopener noreferrer" } : { 'aria-disabled': 'true' })}
      >
        Code
        <HiArrowRight
          className={`ml-1 transition-transform duration-200 ${isCodeValid ? 'group-hover:translate-x-1' : ''}`}
          size={18}
        />
      </a>
    </div>
  </div>
</div>